<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>محول الليرة السورية الذكي</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js'></script>

    <style>
        :root {
            --primary-green: #2e7d32;
            --light-green: #e8f5e9;
            --accent-green: #66bb6a;
            --glass-bg: rgba(255, 255, 255, 0.85);
            --text-dark: #1b3a24;
        }

        body {
            font-family: 'Tajawal', Tahoma, Arial, sans-serif;
            background: linear-gradient(135deg, #f1f8e9 0%, #c8e6c9 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            direction: rtl;
            margin: 0;
            padding: 20px;
        }

        .glass-box {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            width: 100%;
            max-width: 400px;
            padding: 30px 25px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(31, 135, 79, 0.15);
            border: 1px solid rgba(255,255,255,0.6);
            text-align: center;
        }

        h1 { font-size: 24px; color: var(--primary-green); margin-bottom: 5px; }

        .input-group { position: relative; margin-bottom: 10px; display: flex; align-items: center; }

        input[type="text"], select {
            width: 100%;
            padding: 15px;
            padding-left: 50px;
            font-size: 18px;
            border-radius: 12px;
            border: 2px solid transparent;
            background: #fff;
            color: var(--text-dark);
            font-family: inherit;
        }

        .scan-btn {
            position: absolute;
            left: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--light-green);
            color: var(--primary-green);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
        }

        .result { font-size: 28px; font-weight: 800; color: var(--primary-green); margin-top: 10px; }
        
        .interpreted-value { font-size: 12px; color: #666; height: 18px; margin-bottom: 10px; }

        footer { margin-top: 25px; font-size: 12px; color: var(--primary-green); }
        .designer-name { font-weight: bold; color: var(--accent-green); }
    </style>
</head>
<body>

<div class="glass-box">
    <h1><i class="fas fa-coins"></i> محول الليرة الذكي</h1>
    <div style="font-size:13px; color:#558b63; margin-bottom:20px;">يدعم الكتابة الذكية والمسح الضوئي</div>

    <div class="input-group">
        <input type="text" id="amount" placeholder="أدخل الرقم أو اكتبه نصاً..." autocomplete="off">
        <button class="scan-btn" onclick="document.getElementById('fileInput').click()">
            <i class="fas fa-camera"></i>
        </button>
        <input type="file" id="fileInput" accept="image/*" style="display:none" onchange="handleImageScan(event)">
    </div>

    <div class="interpreted-value" id="interpretedText"></div>

    <select id="type" onchange="convert()">
        <option value="oldToNew">▼ من قديم إلى حديث (حذف صفرين)</option>
        <option value="newToOld">▲ من حديث إلى قديم (إضافة صفرين)</option>
    </select>

    <div style="margin:20px auto; width:60px; height:6px; background:var(--accent-green); border-radius:10px; opacity:0.3;"></div>

    <div class="result" id="result">0 ل.س</div>

    <footer>
        © 2025 Syrian Currency Converter <br>
        تصميم وتطوير: <span class="designer-name">عشتار</span>
    </footer>
</div>

<script>
    const wordMap = {'واحد':1,'اثنان':2,'ثلاثة':3,'اربعة':4,'خمسة':5,'ستة':6,'سبعة':7,'ثمانية':8,'تسعة':9,'عشرة':10,'عشرين':20,'ثلاثين':30,'اربعين':40,'خمسين':50,'مئة':100,'ألف':1000,'مليون':1000000};
    
    function parseArabic(text) {
        if (!isNaN(text.replace(/,/g,''))) return parseFloat(text.replace(/,/g,''));
        let total = 0, current = 0;
        text.split(/\s+/).forEach(w => {
            let val = wordMap[w.replace(/(ال|و)/g,"")] || wordMap[w];
            if(val) current += val;
            if(w.includes('ألف') || w.includes('الف')) { total += (current||1)*1000; current=0; }
        });
        return total + current;
    }

    function convert() {
        let val = parseArabic(document.getElementById("amount").value);
        let type = document.getElementById("type").value;
        let res = (type === "oldToNew") ? val/100 : val*100;
        document.getElementById("result").innerHTML = res.toLocaleString() + " <small>ل.س</small>";
        if(navigator.vibrate) navigator.vibrate(20);
    }

    document.getElementById("amount").addEventListener("input", convert);

    function handleImageScan(event) {
        const file = event.target.files[0];
        Tesseract.recognize(file, 'eng').then(({data:{text}}) => {
            const m = text.match(/(\d+)/);
            if(m) { document.getElementById("amount").value = m[0]; convert(); }
        });
    }
</script>
</body>
</html>
